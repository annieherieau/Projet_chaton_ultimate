<%= render "items/flash" %>

<div class="container mt-5">
  <div class="card">
    <div class="card-header">
      New Item
    </div>
    <div class="card-body">
      <%= form_with(model: @item, local: true, html: {class: "needs-validation", novalidate: true}) do |form| %>
        <div class="mb-3">
          <%= form.label :title, class: 'form-label' %>
          <%= form.text_field :title, class: 'form-control', required: true %>
        </div>

        <div class="mb-3">
          <%= form.label :description, class: 'form-label' %>
          <%= form.text_area :description, class: 'form-control', rows: 3, required: true %>
        </div>

        <div class="mb-3">
          <%= form.label :price, class: 'form-label' %>
          <%= form.number_field :price, class: 'form-control', step: '0.01', required: true %>
        </div>

        <div class="mb-3">
          <%= form.label :photo, class: 'form-label' %>
          <%= form.file_field :photo, class: 'form-control', direct_upload: true, onchange: "loadFile(event)" %>
          <img id="output" width="200" class="mt-3"/>
        </div>

        <div class="actions">
          <%= form.submit 'Create Item', class: 'btn btn-primary' %>
        </div>
      <% end %>
    </div>
  </div>
</div>

<script>
  var loadFile = function(event) {
    var output = document.getElementById('output');
    output.src = URL.createObjectURL(event.target.files[0]);
    output.onload = function() {
      URL.revokeObjectURL(output.src) // free memory
    }
  };
</script>
